<!doctype html>
<html lang="ja">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>早押しクイズ - 子機</title>
  </head>

  <body>
    <h1>早押しクイズ 子機</h1>
    <input type="text" id="name-input" placeholder="名前を入力してください" />
    <button id="buzz-btn" disabled>早押し！</button>

    <script>
      const buzzBtn = document.getElementById("buzz-btn");
      const nameInput = document.getElementById("name-input");

      let socket = new WebSocket("wss://hayaoshi-quiz-backend.onrender.com");
      console.log("ソケットに接続しました");
      console.log(socket);

      nameInput.addEventListener("input", () => {
        buzzBtn.disabled = !nameInput.value;
      });

      buzzBtn.addEventListener("click", () => {
        socket.send(
          JSON.stringify({
            type: "buzz",
            name: nameInput.value,
          }),
        );
      });

      socket.onmessage = function (event) {
        const message = JSON.parse(event.data);

        if (message.type === "result") {
          if (
            message.result === "correct" &&
            message.name === nameInput.value
          ) {
            alert("正解！");
          } else if (
            message.result === "wrong" &&
            message.name === nameInput.value
          ) {
            alert("不正解...");
          }
        }
      };
    </script>
  </body>
</html>
